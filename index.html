<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Générateur de Factures Professionnelles</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div id="app">
        <header class="app-header">
            <h1>Générateur de Factures</h1>
        </header>
        
        <main class="app-main">
            <div id="invoice-container">
                <!-- Prévisualisation de la facture -->
                <div class="invoice-preview" id="invoice-preview">
                    <div class="invoice-header">
                        <div class="company-info">
                            <div class="company-logo" id="company-logo-display"></div>
                            <div class="company-details">
                                <h2 id="company-name-display">Nom de l'entreprise</h2>
                                <div id="company-address-display">Adresse de l'entreprise</div>
                                <div id="company-contact-display">
                                    <div id="company-phone-display">Téléphone</div>
                                    <div id="company-email-display">Email</div>
                                </div>
                            </div>
                        </div>
                        <div class="invoice-info">
                            <h3>FACTURE</h3>
                            <div class="invoice-meta">
                                <div>N° <span id="invoice-number-display">001</span></div>
                                <div>Date: <span id="invoice-date-display"></span></div>
                            </div>
                        </div>
                    </div>

                    <div class="invoice-body">
                        <div class="legal-info" id="legal-info-display"></div>
                        
                        <div class="invoice-items">
                            <table class="items-table">
                                <thead>
                                    <tr>
                                        <th id="col-reference">Référence</th>
                                        <th id="col-description">Description</th>
                                        <th id="col-quantity">Qté</th>
                                        <th id="col-unit-price">Prix Unit.</th>
                                        <th id="col-discount">Remise</th>
                                        <th id="col-vat">TVA</th>
                                        <th id="col-total">Total</th>
                                    </tr>
                                </thead>
                                <tbody id="items-list">
                                    <!-- Articles seront ajoutés dynamiquement -->
                                </tbody>
                            </table>

                            <table class="hourly-table">
                                <thead>
                                    <tr>
                                        <th id="col-hourly-description">Prestation</th>
                                        <th id="col-hours">Heures</th>
                                        <th id="col-hourly-rate">Taux/h</th>
                                        <th id="col-hourly-total">Total</th>
                                    </tr>
                                </thead>
                                <tbody id="hourly-items-list">
                                    <!-- Prestations horaires seront ajoutées dynamiquement -->
                                </tbody>
                            </table>
                        </div>

                        <div class="invoice-totals">
                            <div class="totals-row">
                                <span>Sous-total HT:</span>
                                <span id="subtotal-ht-display">0,00 €</span>
                            </div>
                            <div class="totals-row">
                                <span>Total remises:</span>
                                <span id="total-discount-display">0,00 €</span>
                            </div>
                            <div class="totals-row">
                                <span>Total TVA:</span>
                                <span id="total-vat-display">0,00 €</span>
                            </div>
                            <div class="totals-row total-final">
                                <span>Total TTC:</span>
                                <span id="total-ttc-display">0,00 €</span>
                            </div>
                        </div>
                    </div>

                    <div class="invoice-footer">
                        <div id="payment-method-display">Mode de paiement: Virement bancaire</div>
                        <div id="footer-text-display">Merci pour votre confiance</div>
                    </div>
                </div>
                
                <!-- Contrôles de saisie -->
                <div class="invoice-controls">
                    <div class="control-section">
                        <h3>Informations Entreprise</h3>
                        <div class="form-group">
                            <label for="company-name">Nom de l'entreprise *</label>
                            <input type="text" id="company-name" class="input" required>
                        </div>
                        <div class="form-group">
                            <label for="company-logo">Logo</label>
                            <input type="file" id="company-logo" accept="image/*" class="input">
                        </div>
                        <div class="form-group">
                            <label for="company-address">Adresse *</label>
                            <textarea id="company-address" class="input" rows="3" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="company-phone">Téléphone *</label>
                            <input type="tel" id="company-phone" class="input" required>
                        </div>
                        <div class="form-group">
                            <label for="company-email">Email *</label>
                            <input type="email" id="company-email" class="input" required>
                        </div>
                        <div class="form-group">
                            <label for="legal-info">Informations légales</label>
                            <textarea id="legal-info" class="input" rows="2" placeholder="SIRET, TVA intracommunautaire, etc."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="invoice-number">Numéro de facture *</label>
                            <input type="text" id="invoice-number" class="input" required value="001">
                        </div>
                    </div>

                    <div class="control-section">
                        <h3>Articles</h3>
                        <div class="form-group">
                            <label for="item-reference">Référence *</label>
                            <input type="text" id="item-reference" class="input" required>
                        </div>
                        <div class="form-group">
                            <label for="item-description">Description *</label>
                            <input type="text" id="item-description" class="input" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="item-quantity">Quantité *</label>
                                <input type="number" id="item-quantity" class="input" min="0.01" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label for="item-unit-price">Prix unitaire *</label>
                                <input type="number" id="item-unit-price" class="input" min="0.01" step="0.01" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="item-discount">Remise (%)</label>
                                <input type="number" id="item-discount" class="input" min="0" max="100" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label for="item-vat">TVA (%)</label>
                                <input type="number" id="item-vat" class="input" min="0" max="50" step="0.01" value="20">
                            </div>
                        </div>
                        <button type="button" id="add-item" class="btn btn-primary">Ajouter Article</button>
                    </div>

                    <div class="control-section">
                        <h3>Prestations Horaires</h3>
                        <div class="form-group">
                            <label for="hourly-description">Description *</label>
                            <input type="text" id="hourly-description" class="input" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="hourly-hours">Heures *</label>
                                <input type="number" id="hourly-hours" class="input" min="0.1" step="0.1" required>
                            </div>
                            <div class="form-group">
                                <label for="hourly-rate">Taux horaire *</label>
                                <input type="number" id="hourly-rate" class="input" min="1" step="0.01" required>
                            </div>
                        </div>
                        <button type="button" id="add-hourly-item" class="btn btn-primary">Ajouter Prestation</button>
                    </div>

                    <div class="control-section">
                        <h3>Personnalisation</h3>
                        <div class="form-group">
                            <label for="currency-select">Devise</label>
                            <select id="currency-select" class="input">
                                <option value="EUR">EUR (€)</option>
                                <option value="USD">USD ($)</option>
                                <option value="GBP">GBP (£)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="theme-select">Thème</label>
                            <select id="theme-select" class="input">
                                <option value="default">Défaut</option>
                                <option value="modern">Moderne</option>
                                <option value="classic">Classique</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="payment-method">Mode de paiement</label>
                            <input type="text" id="payment-method" class="input" value="Virement bancaire">
                        </div>
                        <div class="form-group">
                            <label for="footer-text">Texte de pied de page</label>
                            <input type="text" id="footer-text" class="input" value="Merci pour votre confiance">
                        </div>
                    </div>

                    <div class="control-section">
                        <h3>Export</h3>
                        <button type="button" id="export-pdf" class="btn btn-secondary">Exporter PDF</button>
                        <button type="button" id="export-jpg" class="btn btn-secondary">Exporter JPG</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="js/models/state.js"></script>
    <script src="js/calculators/ItemCalculator.js"></script>
    <script src="js/calculators/HourlyCalculator.js"></script>
    <script src="js/calculators/TotalCalculator.js"></script>
    <script src="js/managers/InvoiceManager.js"></script>
    <script src="js/managers/ThemeManager.js"></script>
    <script src="js/managers/CurrencyManager.js"></script>
    <script src="js/engines/PDFEngine.js"></script>
    <script src="js/engines/ImageEngine.js"></script>
    <script src="js/invoice-engine.js"></script>
</body>
</html>